{% extends "base.html" %} {% block title %}Weekly Calendar{% endblock %} {%
block extra_head %}
<style>
  /* Existing styles */
</style>
<script>
  $(document).ready(function () {
    $(".calendar-table").each(function () {
      $(this).DataTable({
        paging: false,
        searching: false,
        ordering: false,
        info: false,
        scrollX: true,
      });
    });
  });
</script>
{% endblock %} {% block content %}
<h1>Weekly Calendar View</h1>

{% for month in week_to_month.values()|unique %}
<h2>{{ month }}</h2>
{% for region, staff_list in staff_by_region.items() %}
<h3>{{ region }}</h3>
<table class="dataTable calendar-table">
  <thead>
    <tr>
      <th>Staff</th>
      {% for week in week_to_month if week_to_month[week] == month %}
      <th>Week {{ week }}</th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    {% for s in staff_list %}
    <tr>
      <td>{{ s.name }} ({{ s.role }})</td>
      {% for week in week_to_month if week_to_month[week] == month %}
      <td>
        {% set shifts_in_week = s.shift_assignments | selectattr('Week',
        'equalto', week) | list %} {% if shifts_in_week %} {% for shift in
        shifts_in_week %}
        <div class="shift">{{ shift['Day'] }} - {{ shift['Role'] }}</div>
        {% endfor %} {% else %} &nbsp; {% endif %}
      </td>
      {% endfor %}
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endfor %} {% endfor %} {% endblock %}
